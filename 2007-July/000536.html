<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Socketcan-users] Driver Infrastructure - was Re: socketcan c_can	next try
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2007-July/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20Driver%20Infrastructure%20-%20was%20Re%3A%20socketcan%20c_can%0A%09next%20try&In-Reply-To=%3C46977D3F.4000103%40hartkopp.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000535.html">
   <LINK REL="Next"  HREF="000539.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Socketcan-users] Driver Infrastructure - was Re: socketcan c_can	next try</H1>
    <B>Oliver Hartkopp</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BSocketcan-users%5D%20Driver%20Infrastructure%20-%20was%20Re%3A%20socketcan%20c_can%0A%09next%20try&In-Reply-To=%3C46977D3F.4000103%40hartkopp.net%3E"
       TITLE="[Socketcan-users] Driver Infrastructure - was Re: socketcan c_can	next try">socketcan at hartkopp.net
       </A><BR>
    <I>Fri Jul 13 15:25:19 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000535.html">[Socketcan-users] Driver Infrastructure - was Re: socketcan c_can	next try
</A></li>
        <LI>Next message: <A HREF="000539.html">[Socketcan-users] Driver Infrastructure - was Re: socketcan c_can	next try
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#536">[ date ]</a>
              <a href="thread.html#536">[ thread ]</a>
              <a href="subject.html#536">[ subject ]</a>
              <a href="author.html#536">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Marc Kleine-Budde wrote:
&gt;<i> Urs Thuermann wrote:
</I>&gt;<i>   
</I>&gt;&gt;<i> 	struct sja1000_priv {
</I>&gt;&gt;<i> 		/* This struct must be the first member */
</I>&gt;&gt;<i> 		struct can_priv can;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 		/* SJA1000 specific data */
</I>&gt;&gt;<i> 		foo_t	bar;
</I>&gt;&gt;<i> 	};
</I>&gt;&gt;<i>     
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I think this generally a bad idea...
</I>&gt;<i> (it gives me pain in the stomac)
</I>&gt;<i>
</I>&gt;<i> We can pass around the net_device pointer and use it in the generic 
</I>&gt;<i> code, in the driver we can use container_of to get the surround sja1000 
</I>&gt;<i> struct. In this way we don't rely on things like, &quot;must be the first&quot;.
</I>&gt;<i>   
</I>
Of course you may use container_of() if you feel better with it - and it
is definitely correct to do so.
Btw. if you see common Kernel code container_of() is not always used as
some things (like the placing of the common structs) can ALSO be handled
by coding rules (as proposed by Urs).

I don't have any objections to both approaches. The one from Urs is
commonly used in the Kernel and looks nice in the code.

Oliver

ps. If you would like to reduce pain in the stomac you might want to
rework the install-target in trunk/kernel/2.6/Makefile ;-) It is not
working like you suggested on 2007-06-03 ...



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000535.html">[Socketcan-users] Driver Infrastructure - was Re: socketcan c_can	next try
</A></li>
	<LI>Next message: <A HREF="000539.html">[Socketcan-users] Driver Infrastructure - was Re: socketcan c_can	next try
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#536">[ date ]</a>
              <a href="thread.html#536">[ thread ]</a>
              <a href="subject.html#536">[ subject ]</a>
              <a href="author.html#536">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
