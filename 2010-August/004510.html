<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> can: expected receive behavior broken
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2010-August/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20can%3A%20expected%20receive%20behavior%20broken&In-Reply-To=%3C4C57DE07.9030002%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004521.html">
   <LINK REL="Next"  HREF="004511.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>can: expected receive behavior broken</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20can%3A%20expected%20receive%20behavior%20broken&In-Reply-To=%3C4C57DE07.9030002%40grandegger.com%3E"
       TITLE="can: expected receive behavior broken">wg at grandegger.com
       </A><BR>
    <I>Tue Aug  3 11:14:47 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004521.html">[PATCH] can-raw: Fix skb_orphan_try handling
</A></li>
        <LI>Next message: <A HREF="004511.html">can: expected receive behavior broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4510">[ date ]</a>
              <a href="thread.html#4510">[ thread ]</a>
              <a href="subject.html#4510">[ subject ]</a>
              <a href="author.html#4510">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Oliver,

On 07/29/2010 11:36 AM, Oliver Hartkopp wrote:
&gt;<i> On 28.07.2010 10:23, Matthias Fuchs wrote:
</I>&gt;&gt;<i> plx_pci/sja1000 + esd_usb2
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> Hi Matthias,
</I>&gt;<i> 
</I>&gt;<i> i added a test program to the SVN that checks whether the CAN_RAW_LOOPBACK and
</I>&gt;<i> CAN_RAW_RECV_OWN_MSGS socket options work properly (in can.ko and can-raw-ko
</I>&gt;<i> and vcan.ko).
</I>&gt;<i> 
</I>&gt;<i> So far i was only able to test it on vcan0, as i'm on a business trip and
</I>&gt;<i> don't have a real CAN hardware with me.
</I>&gt;<i> 
</I>&gt;<i> I'll enhance it to force the CAN netdev to be given on the commandline.
</I>&gt;<i> 
</I>&gt;<i> Regarding your request, i was able to see the bad behaviour in the latest
</I>&gt;<i> net-next-2.6. You need to make
</I>&gt;<i> 
</I>&gt;<i>     modprobe vcan echo=1
</I>&gt;<i> 
</I>&gt;<i> before creating vcan devices to test the loopback on driver level!
</I>&gt;<i> 
</I>&gt;<i> Invoking tst-rcv-own-msgs produces this output, which is far away from the
</I>&gt;<i> correct (wanted) output seen in the commit message below.
</I>&gt;<i> 
</I>&gt;<i> sockopt default
</I>&gt;<i>  s : 0
</I>&gt;<i>  t : 0
</I>&gt;<i>  timeout
</I>&gt;<i> sockopt - -
</I>&gt;<i>  timeout
</I>&gt;<i> sockopt - R
</I>&gt;<i>  timeout
</I>&gt;<i> sockopt L -
</I>&gt;<i>  s : 3
</I>&gt;<i>  t : 3
</I>&gt;<i>  timeout
</I>&gt;<i> sockopt L R
</I>&gt;<i>  s : 4
</I>&gt;<i>  t : 4
</I>&gt;<i>  timeout
</I>&gt;<i> done.
</I>
I have some comments on the test program. You might understand what the
above output means but even for me it's completely unclear without
looking to the code. Could you please enhance it with more intuitive
output messages. Especially it should be clear if the test passed
successfully or failed.

Thanks,

Wolfgang.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004521.html">[PATCH] can-raw: Fix skb_orphan_try handling
</A></li>
	<LI>Next message: <A HREF="004511.html">can: expected receive behavior broken
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4510">[ date ]</a>
              <a href="thread.html#4510">[ thread ]</a>
              <a href="subject.html#4510">[ subject ]</a>
              <a href="author.html#4510">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
