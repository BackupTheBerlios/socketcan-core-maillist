<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> at91_can bus off handling (was: Re: (ATTicket:560142) Re: Comments	on at91_can.c)
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2009-September/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20at91_can%20bus%20off%20handling%20%28was%3A%20Re%3A%20%28ATTicket%3A560142%29%20Re%3A%20Comments%0A%09on%20at91_can.c%29&In-Reply-To=%3C4A9FA81F.6080700%40pengutronix.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002966.html">
   <LINK REL="Next"  HREF="002969.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>at91_can bus off handling (was: Re: (ATTicket:560142) Re: Comments	on at91_can.c)</H1>
    <B>Marc Kleine-Budde</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20at91_can%20bus%20off%20handling%20%28was%3A%20Re%3A%20%28ATTicket%3A560142%29%20Re%3A%20Comments%0A%09on%20at91_can.c%29&In-Reply-To=%3C4A9FA81F.6080700%40pengutronix.de%3E"
       TITLE="at91_can bus off handling (was: Re: (ATTicket:560142) Re: Comments	on at91_can.c)">mkl at pengutronix.de
       </A><BR>
    <I>Thu Sep  3 13:27:27 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="002966.html">(ATTicket:560142) Re: Comments on at91_can.c
</A></li>
        <LI>Next message: <A HREF="002969.html">at91_can bus off handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2968">[ date ]</a>
              <a href="thread.html#2968">[ thread ]</a>
              <a href="subject.html#2968">[ subject ]</a>
              <a href="author.html#2968">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hey,

Marc Kleine-Budde wrote:
&gt;&gt;<i> To come back now on the 128 recessive bits, that's very easy to have
</I>&gt;&gt;<i> them: as soon as the bus is idle (no other can nodes transmitted) you
</I>&gt;&gt;<i> should have '1' on the line so immediately you will have your 128
</I>&gt;&gt;<i> bits sequence completed and so you will have exited from the BOFF
</I>&gt;&gt;<i> mode.
</I>&gt;<i> 
</I>&gt;<i> Thanks for the clarification. I've found the section in the CAN
</I>&gt;<i> patent[1], it's talking explicit a about an idle bus. I should have
</I>&gt;<i> looked there before :)
</I>
As we've learned CAN controllers can leave Bus off without further
interaction. Looking at the data sheet of the HECC it has the same
&quot;problem&quot;, too.

IIRC Anant handles the problem by disabling all interrupts in the bus
off case, thus the driver will not notice if the chip goes into the
error active. I'll try this workaround for the at91, too.

Cheers, Marc

- --
Pengutronix e.K.                         | Marc Kleine-Budde           |
Linux Solutions for Science and Industry | Phone: +49-231-2826-924     |
Vertretung West/Dortmund                 | Fax:   +49-5121-206917-5555 |
Amtsgericht Hildesheim, HRA 2686         | <A HREF="http://www.pengutronix.de">http://www.pengutronix.de</A>   |
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.9 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org">http://enigmail.mozdev.org</A>

iEYEARECAAYFAkqfqB4ACgkQjTAFq1RaXHPHhQCdHmM5Go21I6BhLrKlnpQuA/oH
DcwAn29D71k6pkSICpmXlfUKOVzM9NMy
=aIcq
-----END PGP SIGNATURE-----

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002966.html">(ATTicket:560142) Re: Comments on at91_can.c
</A></li>
	<LI>Next message: <A HREF="002969.html">at91_can bus off handling
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2968">[ date ]</a>
              <a href="thread.html#2968">[ thread ]</a>
              <a href="subject.html#2968">[ subject ]</a>
              <a href="author.html#2968">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
