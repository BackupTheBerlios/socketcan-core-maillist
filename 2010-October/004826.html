<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [RFC] CAN frames with RTR and dlc != 0
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2010-October/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BRFC%5D%20CAN%20frames%20with%20RTR%20and%20dlc%20%21%3D%200&In-Reply-To=%3C4CC031F3.4060706%40pengutronix.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004877.html">
   <LINK REL="Next"  HREF="004828.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[RFC] CAN frames with RTR and dlc != 0</H1>
    <B>Marc Kleine-Budde</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BRFC%5D%20CAN%20frames%20with%20RTR%20and%20dlc%20%21%3D%200&In-Reply-To=%3C4CC031F3.4060706%40pengutronix.de%3E"
       TITLE="[RFC] CAN frames with RTR and dlc != 0">mkl at pengutronix.de
       </A><BR>
    <I>Thu Oct 21 14:28:35 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004877.html">[PATCH 00/10] can: at91: bugfixes and improvements
</A></li>
        <LI>Next message: <A HREF="004828.html">[RFC] CAN frames with RTR and dlc != 0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4826">[ date ]</a>
              <a href="thread.html#4826">[ thread ]</a>
              <a href="subject.html#4826">[ subject ]</a>
              <a href="author.html#4826">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Moin,

the socket CAN implementation allows sending of CAN frames with RTR set
and dlc != 0. My question is what should be received?

I've tested several CAN cores (sja1000, mcp2515, at91_can) and all
receive the RTR bit and set the dlc correct, but the data is not handled
as expected. On the at91 and mcp2515 it seems that we get the old
mailbox data, on the sja1000 we get the old data but shifted by several
bytes.

Our options are:
leave as it is, or combinations of these:

1) drop frames with RTR &amp;&amp; dlc != 0
2) set dlc = 0 if RTR is set
3) set data = to 0 if RTR is set

a) during RX
b) during TX

cheers, Marc
-- 
Pengutronix e.K.                  | Marc Kleine-Budde           |
Industrial Linux Solutions        | Phone: +49-231-2826-924     |
Vertretung West/Dortmund          | Fax:   +49-5121-206917-5555 |
Amtsgericht Hildesheim, HRA 2686  | <A HREF="http://www.pengutronix.de">http://www.pengutronix.de</A>   |

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 262 bytes
Desc: OpenPGP digital signature
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/socketcan-core/attachments/20101021/15c8d015/attachment.pgp">https://lists.berlios.de/pipermail/socketcan-core/attachments/20101021/15c8d015/attachment.pgp</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004877.html">[PATCH 00/10] can: at91: bugfixes and improvements
</A></li>
	<LI>Next message: <A HREF="004828.html">[RFC] CAN frames with RTR and dlc != 0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4826">[ date ]</a>
              <a href="thread.html#4826">[ thread ]</a>
              <a href="subject.html#4826">[ subject ]</a>
              <a href="author.html#4826">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
