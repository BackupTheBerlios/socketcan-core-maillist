<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> RFC Loopback implementation
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2006-October/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20RFC%20Loopback%20implementation&In-Reply-To=%3C453745AB.6030706%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000373.html">
   <LINK REL="Next"  HREF="000380.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>RFC Loopback implementation</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20RFC%20Loopback%20implementation&In-Reply-To=%3C453745AB.6030706%40grandegger.com%3E"
       TITLE="RFC Loopback implementation">wg at grandegger.com
       </A><BR>
    <I>Thu Oct 19 11:30:19 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000373.html">RFC Loopback implementation
</A></li>
        <LI>Next message: <A HREF="000380.html">RFC Loopback implementation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#378">[ date ]</a>
              <a href="thread.html#378">[ thread ]</a>
              <a href="subject.html#378">[ subject ]</a>
              <a href="author.html#378">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Robert Schwebel wrote:
&gt;<i> On Thu, Oct 19, 2006 at 10:17:15AM +0200, Wolfgang Grandegger wrote:
</I>&gt;&gt;<i> Yes, if you use more than one TX hardware buffer, the sending order is 
</I>&gt;&gt;<i> defined by the hardware (and not when they get filled). I already 
</I>&gt;&gt;<i> observed that behavior on MSCAN-MPC5200, which has 3 TX buffers. This 
</I>&gt;&gt;<i> behavior is _unacceptable_ for &quot;real-time&quot;  and I will therefore switch 
</I>&gt;&gt;<i> back to using just one TX buffer or use the &quot;priority&quot; field for 
</I>&gt;&gt;<i> RT-Socket-CAN. Also without priority field, the TX buffers could be 
</I>&gt;&gt;<i> filled in a more clever way taking into account the internal priorities, 
</I>&gt;&gt;<i> but this is more tricky, of course.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> But I also read, that the TX buffer must be refilled quickly (within the 
</I>&gt;&gt;<i> IFS) to avoid re-arbitration. Multiply TX hardware buffers relax this 
</I>&gt;&gt;<i> requirement, especially at high baud-rates. Also doing the TX loopback 
</I>&gt;&gt;<i> at TX done interrupt time will have some impact. Do you or anybody else 
</I>&gt;&gt;<i> have some experience on this issue (performance?).
</I>&gt;<i> 
</I>&gt;<i> Folks, don't take realtime ad absurdum. The CAN bus is per definition no
</I>&gt;<i> realtime medium. It just specifies that if you send a higher priority
</I>&gt;<i> paket it will win the arbitration over a lower priority one. Not more
</I>&gt;<i> and not less. Killing overall message behaviour without having defined
</I>&gt;<i> real world application requirements doesn't sound sane to me.
</I>
Is this really the case? On the i82587 and the MSCAN the TX message 
objects with the lowest number will be send out first (in case the 
priority field is the same on MSCAN). A queue of a few messages might be 
OK for real-time but 32 messages will cause substantial latencies. And 
as I mentioned already, I think the sending order could be ensured by a 
more clever filling and handling of the TX hardware buffers.


&gt;<i> So if message ordering is only important for debugging, I'd suggest
</I>&gt;<i> attaching a second system to the bus and using that for debugging.
</I>
Note that we are not the big supporters of the TX loopback but it might 
be useful in some applications.

Wolfgang.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000373.html">RFC Loopback implementation
</A></li>
	<LI>Next message: <A HREF="000380.html">RFC Loopback implementation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#378">[ date ]</a>
              <a href="thread.html#378">[ thread ]</a>
              <a href="subject.html#378">[ subject ]</a>
              <a href="author.html#378">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
