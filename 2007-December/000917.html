<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> RFC: CAN state management
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2007-December/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20RFC%3A%20CAN%20state%20management&In-Reply-To=%3C47554F68.4030807%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000910.html">
   <LINK REL="Next"  HREF="000915.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>RFC: CAN state management</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20RFC%3A%20CAN%20state%20management&In-Reply-To=%3C47554F68.4030807%40grandegger.com%3E"
       TITLE="RFC: CAN state management">wg at grandegger.com
       </A><BR>
    <I>Tue Dec  4 14:00:24 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000910.html">RFC: CAN state management
</A></li>
        <LI>Next message: <A HREF="000915.html">RFC: CAN state management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#917">[ date ]</a>
              <a href="thread.html#917">[ thread ]</a>
              <a href="subject.html#917">[ subject ]</a>
              <a href="author.html#917">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Oliver Hartkopp wrote:
&gt;<i> Oliver Hartkopp wrote:
</I>&gt;&gt;<i> Wolfgang Grandegger wrote:
</I>&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i> Robert Schwebel wrote:
</I>&gt;&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i>     
</I>&gt;&gt;&gt;&gt;<i> What about the variant we discussed in Nurmberg, which is transporting
</I>&gt;&gt;&gt;&gt;<i> the state information via sysfs (for polling) *and* via error frames for
</I>&gt;&gt;&gt;&gt;<i> applications which want to get the information on a per-message base?
</I>&gt;&gt;&gt;&gt;<i>  
</I>&gt;&gt;<i> Or we introduce a new CAN_ERR_STATECHANGE you can set your error filter
</I>&gt;&gt;<i> to. Hm - it's not really an error (like CAN_ERR_RESTARTED) but whenever
</I>&gt;&gt;<i> a statechange is detected by the driver the userspace application might
</I>&gt;&gt;<i> look into the sysfs to determin the current state without polling.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   
</I>&gt;<i> 
</I>&gt;<i> Sorry for the additional mail but i just had the idea to define a
</I>&gt;<i> 
</I>&gt;<i> CAN_ERR_STATE
</I>&gt;<i> 
</I>&gt;<i> analogue to CAN_ERR_PROT or CAN_ERR_CTRL that carries the additional
</I>&gt;<i> information ('the state') in data[5] of the error frame.
</I>&gt;<i> 
</I>&gt;<i> So whenever you are interested in state changes you just filter for
</I>&gt;<i> CAN_ERR_STATE and get the state from the sysfs within the error frame.
</I>&gt;<i> The possibility to get the state from the sysfs should remain in any case.
</I>
Ah, I should have read this mail first. That's what I suggested in my
previous mail. Another possibility would be to add the state to each CAN
frame (there should be still space for one byte). That would avoid the
state polling almost completely.

Wolfgang.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000910.html">RFC: CAN state management
</A></li>
	<LI>Next message: <A HREF="000915.html">RFC: CAN state management
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#917">[ date ]</a>
              <a href="thread.html#917">[ thread ]</a>
              <a href="subject.html#917">[ subject ]</a>
              <a href="author.html#917">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
