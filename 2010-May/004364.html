<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [PATCH 0/5] general improvement of can-calc-bit-timing
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2010-May/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%200/5%5D%20general%20improvement%20of%20can-calc-bit-timing&In-Reply-To=%3C4BF0F3E5.9050908%40pengutronix.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="004362.html">
   <LINK REL="Next"  HREF="004365.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[PATCH 0/5] general improvement of can-calc-bit-timing</H1>
    <B>Marc Kleine-Budde</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%200/5%5D%20general%20improvement%20of%20can-calc-bit-timing&In-Reply-To=%3C4BF0F3E5.9050908%40pengutronix.de%3E"
       TITLE="[PATCH 0/5] general improvement of can-calc-bit-timing">mkl at pengutronix.de
       </A><BR>
    <I>Mon May 17 09:44:37 CEST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="004362.html">[PATCH 0/5] general improvement of can-calc-bit-timing
</A></li>
        <LI>Next message: <A HREF="004365.html">[PATCH 0/5] general improvement of can-calc-bit-timing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4364">[ date ]</a>
              <a href="thread.html#4364">[ thread ]</a>
              <a href="subject.html#4364">[ subject ]</a>
              <a href="author.html#4364">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Wolfgang Grandegger wrote:
&gt;<i> Hi Marc,
</I>&gt;<i> 
</I>&gt;<i> On 05/17/2010 12:46 AM, Marc Kleine-Budde wrote:
</I>&gt;&gt;<i> Hey Wolfgang,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Marc Kleine-Budde wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> The patch series can be viewed as as git tree under:
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="http://git.pengutronix.de/?p=mkl/berlios-can-utils.git;a=shortlog;h=refs/heads/pu">http://git.pengutronix.de/?p=mkl/berlios-can-utils.git;a=shortlog;h=refs/heads/pu</A>
</I>&gt;&gt;&gt;&gt;<i> I would prefer to make the struct can_bittiming_const compatible with
</I>&gt;&gt;&gt;&gt;<i> the one used by the kernel:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="http://lxr.linux.no/#linux+v2.6.33/drivers/net/can/sja1000/sja1000.c#L75">http://lxr.linux.no/#linux+v2.6.33/drivers/net/can/sja1000/sja1000.c#L75</A>
</I>&gt;&gt;<i> The common members have now the same names, but there's still the printf_btr
</I>&gt;&gt;<i> and I add a ref_clock in a later patch.....
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I forgot to mention that, sorry. Should not be a big deal, though.
</I>&gt;&gt;&gt;<i> There're more patches to come. And one of this does exactly this. I just
</I>&gt;&gt;&gt;<i> have to write a decent commit message for the last patch, then I'll send it.
</I>&gt;&gt;<i> Here they are...they are based on the other series I posted earlier.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> It's available as a git tree at:
</I>&gt;&gt;<i> <A HREF="http://git.pengutronix.de/?p=mkl/berlios-can-utils.git;a=shortlog;h=refs/heads/rfc/better-bitrate-calculation">http://git.pengutronix.de/?p=mkl/berlios-can-utils.git;a=shortlog;h=refs/heads/rfc/better-bitrate-calculation</A>
</I>&gt;<i> 
</I>&gt;<i> Looks good at a first glance and they could go in immediately. We can
</I>&gt;<i> add fixes later on, if necessary. One requirement of the algorithm is
</I>&gt;<i> that it *must* reproduce the CIA recommanded values for the SJA1000 for
</I>&gt;<i> the standard bit-rates. We should not expect that it works for any
</I>
Have a look at patch 5. In it's patch description is a diff of output of
the original and the improved version. As you can see no changes for the
sja.

The original algorithm find optimal values for the sja (no bitrate error
and no sample point error). My patch just optimizes the sample point in
cases where you cannot avoid bitrate errors.

&gt;<i> bitrate, especially with exotic clock frequencies. Those require manual
</I>&gt;<i> fiddling with the bit-timing parameters, e.g. SJW, which is non-trivial.
</I>
I tend to call them &quot;real live&quot; clock values :)

cheers, Marc
-- 
Pengutronix e.K.                  | Marc Kleine-Budde           |
Industrial Linux Solutions        | Phone: +49-231-2826-924     |
Vertretung West/Dortmund          | Fax:   +49-5121-206917-5555 |
Amtsgericht Hildesheim, HRA 2686  | <A HREF="http://www.pengutronix.de">http://www.pengutronix.de</A>   |

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 260 bytes
Desc: OpenPGP digital signature
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/socketcan-core/attachments/20100517/b22b2e51/attachment.pgp">https://lists.berlios.de/pipermail/socketcan-core/attachments/20100517/b22b2e51/attachment.pgp</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="004362.html">[PATCH 0/5] general improvement of can-calc-bit-timing
</A></li>
	<LI>Next message: <A HREF="004365.html">[PATCH 0/5] general improvement of can-calc-bit-timing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#4364">[ date ]</a>
              <a href="thread.html#4364">[ thread ]</a>
              <a href="subject.html#4364">[ subject ]</a>
              <a href="author.html#4364">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
