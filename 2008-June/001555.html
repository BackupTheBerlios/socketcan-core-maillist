<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [PATCH 1/1]: Support EMS CPC-CARD
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2008-June/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%201/1%5D%3A%20Support%20EMS%20CPC-CARD&In-Reply-To=%3C48591BB0.8030705%40ems-wuensche.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001554.html">
   <LINK REL="Next"  HREF="001557.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[PATCH 1/1]: Support EMS CPC-CARD</H1>
    <B>Sebastian Haas</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%201/1%5D%3A%20Support%20EMS%20CPC-CARD&In-Reply-To=%3C48591BB0.8030705%40ems-wuensche.com%3E"
       TITLE="[PATCH 1/1]: Support EMS CPC-CARD">haas at ems-wuensche.com
       </A><BR>
    <I>Wed Jun 18 16:29:04 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001554.html">[PATCH 1/1]: Support EMS CPC-CARD
</A></li>
        <LI>Next message: <A HREF="001557.html">[PATCH 1/1]: Support EMS CPC-CARD
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1555">[ date ]</a>
              <a href="thread.html#1555">[ thread ]</a>
              <a href="subject.html#1555">[ subject ]</a>
              <a href="author.html#1555">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Oliver Hartkopp schrieb:
&gt;<i> Wolfgang Grandegger wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Sebastian Haas wrote:
</I>&gt;&gt;<i> &gt; Wolfgang Grandegger schrieb:
</I>&gt;&gt;<i> &gt;&gt; Sebastian Haas wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt;&gt; Nevertheless, you could also achieve this by disabling and re-enabling
</I>&gt;&gt;<i> &gt;&gt; the IRQ of the other device at the beginning and end of the ISR. You
</I>&gt;&gt;<i> &gt;&gt; could use the pre_irq and post_irq callbacks for that purpose.
</I>&gt;&gt;<i> &gt; That's worth a try. If we disable them in pre_irq, I think the IRQ
</I>&gt;&gt;<i> active bits
</I>&gt;&gt;<i> &gt; disappears and hence the sja1000_interrupt returns immediately,
</I>&gt;&gt;<i> isn't it?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This needs some more careful evaluation. Will check the SJA1000 later
</I>&gt;&gt;<i> today.
</I>Wolfgang, I really think this IRQ active flags gets lost. The external IRQ
line of the SJA1000 is just a ORed result of the internal IRQ active bits.
If we disable them the IRQ active bit are disappears. The Rx IRQ and Data
Overrun may come back immediately after reeenabling them since we've not
actively cleared them (release receive buffer and clear data overrun).

&gt;<i> IMO the problem hides in the sentence:
</I>&gt;<i> 
</I>&gt;<i> &quot;by disabling and re-enabling the IRQ of the other device&quot;
</I>&gt;<i> 
</I>&gt;<i> How to get the 'other device'?
</I>sja1000-&gt;priv *sja1000 = netdev_priv(devid);
ems_pcmcia_card *card = sja1000-&gt;priv;

No problem.

Doesn't the ixxat driver the same way?

- --
Mit freundlichen Gruessen/Best Regards,

Sebastian Haas
Software Entwicklung/Software Development

Phone: +49-9451-9432-22
Fax  : +49-9451-9432-12
Email: <A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-core">haas at ems-wuensche.com</A>
Web  : www.ems-wuensche.com
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.6 (GNU/Linux)
Comment: Using GnuPG with Mozilla - <A HREF="http://enigmail.mozdev.org">http://enigmail.mozdev.org</A>

iD8DBQFIWRuvpqRB8PJG7XwRAnxWAJ9tEnn0Naz/Pe2w/zomhGOqkPl3LQCgg7LM
vt2ySK4ypiYrAkLo59oYgb4=
=UHV7
-----END PGP SIGNATURE-----
-- 
EMS Dr. Thomas Wuensche e.K.
Sonnenhang 3
85304 Ilmmuenster
HRA Neuburg a.d. Donau, HR-Nr. 70.106
Phone: +49-8441-490260
Fax  : +49-8441-81860
<A HREF="http://www.ems-wuensche.com">http://www.ems-wuensche.com</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001554.html">[PATCH 1/1]: Support EMS CPC-CARD
</A></li>
	<LI>Next message: <A HREF="001557.html">[PATCH 1/1]: Support EMS CPC-CARD
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1555">[ date ]</a>
              <a href="thread.html#1555">[ thread ]</a>
              <a href="subject.html#1555">[ subject ]</a>
              <a href="author.html#1555">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
