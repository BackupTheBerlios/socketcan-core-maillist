<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [PATCH] REC and TEC
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2008-December/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%5D%20REC%20and%20TEC&In-Reply-To=%3C49366023.5080001%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002129.html">
   <LINK REL="Next"  HREF="002132.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[PATCH] REC and TEC</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%5D%20REC%20and%20TEC&In-Reply-To=%3C49366023.5080001%40grandegger.com%3E"
       TITLE="[PATCH] REC and TEC">wg at grandegger.com
       </A><BR>
    <I>Wed Dec  3 11:32:03 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002129.html">[PATCH] REC and TEC
</A></li>
        <LI>Next message: <A HREF="002132.html">[PATCH] REC and TEC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2130">[ date ]</a>
              <a href="thread.html#2130">[ thread ]</a>
              <a href="subject.html#2130">[ subject ]</a>
              <a href="author.html#2130">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Claudio Lanconelli wrote:
&gt;<i> Wolfgang Grandegger wrote:
</I>&gt;&gt;<i> What again is the motivation to display the maximum value of txerr and
</I>&gt;&gt;<i> rxerr and not the values directly?
</I>&gt;<i> 
</I>&gt;<i> As explained also by Oliver txerr and rxerr are floating because they
</I>&gt;<i> are incremented on tx/rx error and decremented on tx/rx success. So
</I>&gt;<i> sampling only the instantaneous values you can miss something and are
</I>&gt;<i> not sufficient to know the real status of the line.
</I>
OK.

&gt;<i> Oliver Hartkopp wrote:
</I>&gt;&gt;<i> Wolfgang Grandegger wrote:
</I>&gt;&gt;&gt;<i> Well, to be honest, if we add something, I would prefer can_txerr
</I>&gt;&gt;&gt;<i> can_rxerr files instead of this fancy can_link_quality. Most people will
</I>&gt;&gt;&gt;<i> not understand it's meaning, also because the name link quality is
</I>&gt;&gt;&gt;<i> somehow misleading. The counters actually reflect the error state which
</I>&gt;&gt;&gt;<i> usually just increases.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i> But depending on *correct* message receptions the error counters can
</I>&gt;&gt;<i> also decrease ...
</I>&gt;&gt;<i> So all these error values are continuously floating.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I can follow your argumentation regarding the 'can_link_quality' -
</I>&gt;&gt;<i> thanks for the feedback.
</I>&gt;&gt;<i> Bringing all our ideas to a conclusion, it's maybe something like this:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Introduce two sysfs entries
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> /sys/class/net/can0/can_max_txerr
</I>&gt;&gt;<i> /sys/class/net/can0/can_max_rxerr
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> That hold the maximum values of these error counters and are reset to
</I>&gt;&gt;<i> zero on sysfs read.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Btw. IMO there's no pressure on this - we should push the mature drivers
</I>&gt;&gt;<i> to mainline first ...
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i> Oliver
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> Wolfgang Grandegger wrote:
</I>&gt;&gt;<i> I don't like the reset on read, I actually would prefer a reset on
</I>&gt;&gt;<i> write. And as max_txerr and max_rxerr are accumulated values, we may
</I>&gt;&gt;<i> simply add them to the CAN statistics in
</I>&gt;&gt;<i> /sys/class/net/can0/can_statistics requiring less code.
</I>&gt;<i> 
</I>&gt;<i> max_txerr and max_rxerr ARE NOT accumulated values, see explanation above.
</I>
These are the maximum values realized since the last start or value
reset. For me it would make sense to add them to can_statistics.

&gt;<i> I can change it to reset on write (by writing 0). I didn't add them to
</I>&gt;<i> can_statistics because can_statistics are read-only.
</I>
This feature would be useful for CAN statistics values in general. Well,
the CAN statistics stuff need some review anyhow. I'm just thinking how
we could integrate it finally. For testing purposes it's OK what you
already have. Just for curiosity, how does your application use these
values?

Wolfgang.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002129.html">[PATCH] REC and TEC
</A></li>
	<LI>Next message: <A HREF="002132.html">[PATCH] REC and TEC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2130">[ date ]</a>
              <a href="thread.html#2130">[ thread ]</a>
              <a href="subject.html#2130">[ subject ]</a>
              <a href="author.html#2130">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
