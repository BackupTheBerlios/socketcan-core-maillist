<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%200/10%5D%20SJA1000DEV%20using%20device%20interface%20and%20further%20fixes%0A%09and%20improvements&In-Reply-To=%3C47453FE0.6030206%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000846.html">
   <LINK REL="Next"  HREF="000849.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%200/10%5D%20SJA1000DEV%20using%20device%20interface%20and%20further%20fixes%0A%09and%20improvements&In-Reply-To=%3C47453FE0.6030206%40grandegger.com%3E"
       TITLE="[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements">wg at grandegger.com
       </A><BR>
    <I>Thu Nov 22 09:37:52 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000846.html">[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
</A></li>
        <LI>Next message: <A HREF="000849.html">[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#845">[ date ]</a>
              <a href="thread.html#845">[ thread ]</a>
              <a href="subject.html#845">[ subject ]</a>
              <a href="author.html#845">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hans-J&#252;rgen Koch wrote:
&gt;<i> Am Wed, 21 Nov 2007 21:59:53 +0100
</I>&gt;<i> schrieb Wolfgang Grandegger &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-core">wg at grandegger.com</A>&gt;:
</I>&gt;<i> 
</I>&gt;&gt;<i> Oliver Hartkopp wrote:
</I>&gt;&gt;&gt;<i> Sam Ravnborg wrote:
</I>&gt;&gt;<i> [...deletions...]
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> --- trunk.orig/kernel/2.6/net/can/proc.c
</I>&gt;&gt;&gt;&gt;<i> +++ trunk/kernel/2.6/net/can/proc.c
</I>&gt;&gt;&gt;&gt;<i> @@ -46,6 +46,8 @@
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> General comment.. The direction is to restrict /proc to process
</I>&gt;&gt;&gt;&gt;<i> information and keep info such as what the CAN subsystem provides
</I>&gt;&gt;&gt;&gt;<i> in dedicated &quot;one-value-per-file&quot; sysfs files.
</I>&gt;&gt;&gt;&gt;<i>   
</I>&gt;&gt;&gt;<i> Oh. Thanks for this remark! Robert already acceded to use the sysfs
</I>&gt;&gt;&gt;<i> for the CAN netdrivers in another mail and looking into the sysfs i
</I>&gt;&gt;&gt;<i> feel the same :-)
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> So the CAN netdevices could be found e.g.
</I>&gt;&gt;&gt;<i> under /sys/class/net/can0 , right?
</I>&gt;&gt;<i> It's like that on my PC:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>   # ls  /sys/class/net/
</I>&gt;&gt;<i>   can0  can1  eth0  lo
</I>&gt;<i> 
</I>&gt;<i> Hi Wolfgang,
</I>&gt;<i> these are files generated by the netdev core, not by the driver. They
</I>&gt;<i> have a well-defined sysfs interface that creates these symlinks. If you
</I>&gt;<i> follow these, you see the real attributes for the device, e.g. for my
</I>&gt;<i> eth1:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-core">hans at blackbox</A>&gt;0 /sys/class/net/eth1 $ ls -l
</I>&gt;<i> insgesamt 0
</I>&gt;<i> -r--r--r-- 1 root root 4096 2007-11-22 09:49 address
</I>&gt;<i> -r--r--r-- 1 root root 4096 2007-11-22 08:14 addr_len
</I>&gt;<i> -r--r--r-- 1 root root 4096 2007-11-22 08:14 broadcast
</I>&gt;<i> -r--r--r-- 1 root root 4096 2007-11-22 08:14 carrier
</I>&gt;<i> lrwxrwxrwx 1 root root    0 2007-11-22 08:14 device
</I>&gt;<i> -&gt; ../../../../../../devices/pci0000:00/0000:00:07.0/0000:02:00.0
</I>&gt;<i> -r--r--r-- 1 root root 4096 2007-11-22 08:14 dormant -r--r--r-- 1 root
</I>&gt;<i> root 4096 2007-11-22 08:14 features -rw-r--r-- 1 root root 4096
</I>&gt;<i> 2007-11-22 08:14 flags -r--r--r-- 1 root root 4096 2007-11-22 08:14
</I>&gt;<i> ifindex -r--r--r-- 1 root root 4096 2007-11-22 08:14 iflink
</I>&gt;<i> -r--r--r-- 1 root root 4096 2007-11-22 08:14 link_mode
</I>&gt;<i> -rw-r--r-- 1 root root 4096 2007-11-22 08:14 mtu
</I>&gt;<i> -r--r--r-- 1 root root 4096 2007-11-22 08:14 operstate
</I>&gt;<i> drwxr-xr-x 2 root root    0 2007-11-22 08:14 power
</I>&gt;<i> drwxr-xr-x 2 root root    0 2007-11-22 08:14 statistics
</I>&gt;<i> lrwxrwxrwx 1 root root    0 2007-11-22 08:14 subsystem
</I>&gt;<i> -&gt; ../../../../../../class/net -rw-r--r-- 1 root root 4096 2007-11-22
</I>&gt;<i> 08:14 tx_queue_len -r--r--r-- 1 root root 4096 2007-11-22 08:14 type
</I>&gt;<i> -rw-r--r-- 1 root root 4096 2007-11-22 08:14 uevent
</I>
I know.

&gt;<i> IMHO, this is where a CAN driver could add more attributes. AFAIK, all
</I>&gt;<i> of the above are created by the netdev core, so a CAN driver doesn't
</I>&gt;<i> need extra code for these. It might be just &quot;baudrate&quot; that should be
</I>&gt;<i> added here. We should define a set of attributes that every socketcan
</I>&gt;<i> driver must create. This is necessary because userspace code must rely
</I>&gt;<i> on certain files to be present. We cannot have one driver create a
</I>&gt;<i> &quot;baudrate&quot; file and another calling the same thing &quot;speed&quot; or so.
</I>
Baudrate setting could be handled in the common CAN device interface
code. And there might be driver specific parameters as well. But step by
step, speed, baudrate or bitrate, we have not even decided on what name
to use.

&gt;<i> You could also have a look at hwmon, where almost every driver adds
</I>&gt;<i> _lots_ of sysfs attributes (lm93 creates about 160 sysfs files).
</I>
Well, not really the developers dream.

&gt;<i> For now, I'd suggest to create a text file called socketcan-sysfs,
</I>&gt;<i> define the &quot;baudrate&quot; attribute there, and add it to Documentation/.
</I>&gt;<i> Then we should add it to _every_ driver. Other attributes can be added
</I>&gt;<i> when needed. And we should ask the netdev people if they agree.
</I>
OK, but that's close to the end of my to-do list but investigating
already now is useful. Feel free to dig deeper.

Wolfgang.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000846.html">[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
</A></li>
	<LI>Next message: <A HREF="000849.html">[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#845">[ date ]</a>
              <a href="thread.html#845">[ thread ]</a>
              <a href="subject.html#845">[ subject ]</a>
              <a href="author.html#845">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
