<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [PATCH 0/10] SJA1000DEV using device interface and further	fixes and improvements
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2007-November/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%200/10%5D%20SJA1000DEV%20using%20device%20interface%20and%20further%0A%09fixes%20and%20improvements&In-Reply-To=%3C20071122083547.32ef168e%40dilbert.local%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000840.html">
   <LINK REL="Next"  HREF="000843.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[PATCH 0/10] SJA1000DEV using device interface and further	fixes and improvements</H1>
    <B>Hans-J&#252;rgen Koch</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%200/10%5D%20SJA1000DEV%20using%20device%20interface%20and%20further%0A%09fixes%20and%20improvements&In-Reply-To=%3C20071122083547.32ef168e%40dilbert.local%3E"
       TITLE="[PATCH 0/10] SJA1000DEV using device interface and further	fixes and improvements">hjk at linutronix.de
       </A><BR>
    <I>Thu Nov 22 08:35:47 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000840.html">[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
</A></li>
        <LI>Next message: <A HREF="000843.html">[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#842">[ date ]</a>
              <a href="thread.html#842">[ thread ]</a>
              <a href="subject.html#842">[ subject ]</a>
              <a href="author.html#842">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am Wed, 21 Nov 2007 21:59:53 +0100
schrieb Wolfgang Grandegger &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-core">wg at grandegger.com</A>&gt;:

&gt;<i> Oliver Hartkopp wrote:
</I>&gt;<i> &gt; Sam Ravnborg wrote:
</I>&gt;<i> [...deletions...]
</I>&gt;<i> 
</I>&gt;<i> &gt;&gt; --- trunk.orig/kernel/2.6/net/can/proc.c
</I>&gt;<i> &gt;&gt; +++ trunk/kernel/2.6/net/can/proc.c
</I>&gt;<i> &gt;&gt; @@ -46,6 +46,8 @@
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; General comment.. The direction is to restrict /proc to process
</I>&gt;<i> &gt;&gt; information and keep info such as what the CAN subsystem provides
</I>&gt;<i> &gt;&gt; in dedicated &quot;one-value-per-file&quot; sysfs files.
</I>&gt;<i> &gt;&gt;   
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Oh. Thanks for this remark! Robert already acceded to use the sysfs
</I>&gt;<i> &gt; for the CAN netdrivers in another mail and looking into the sysfs i
</I>&gt;<i> &gt; feel the same :-)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; So the CAN netdevices could be found e.g.
</I>&gt;<i> &gt; under /sys/class/net/can0 , right?
</I>&gt;<i> 
</I>&gt;<i> It's like that on my PC:
</I>&gt;<i> 
</I>&gt;<i>   # ls  /sys/class/net/
</I>&gt;<i>   can0  can1  eth0  lo
</I>
Hi Wolfgang,
these are files generated by the netdev core, not by the driver. They
have a well-defined sysfs interface that creates these symlinks. If you
follow these, you see the real attributes for the device, e.g. for my
eth1:

<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-core">hans at blackbox</A>&gt;0 /sys/class/net/eth1 $ ls -l
insgesamt 0
-r--r--r-- 1 root root 4096 2007-11-22 09:49 address
-r--r--r-- 1 root root 4096 2007-11-22 08:14 addr_len
-r--r--r-- 1 root root 4096 2007-11-22 08:14 broadcast
-r--r--r-- 1 root root 4096 2007-11-22 08:14 carrier
lrwxrwxrwx 1 root root    0 2007-11-22 08:14 device
-&gt; ../../../../../../devices/pci0000:00/0000:00:07.0/0000:02:00.0
-r--r--r-- 1 root root 4096 2007-11-22 08:14 dormant -r--r--r-- 1 root
root 4096 2007-11-22 08:14 features -rw-r--r-- 1 root root 4096
2007-11-22 08:14 flags -r--r--r-- 1 root root 4096 2007-11-22 08:14
ifindex -r--r--r-- 1 root root 4096 2007-11-22 08:14 iflink
-r--r--r-- 1 root root 4096 2007-11-22 08:14 link_mode
-rw-r--r-- 1 root root 4096 2007-11-22 08:14 mtu
-r--r--r-- 1 root root 4096 2007-11-22 08:14 operstate
drwxr-xr-x 2 root root    0 2007-11-22 08:14 power
drwxr-xr-x 2 root root    0 2007-11-22 08:14 statistics
lrwxrwxrwx 1 root root    0 2007-11-22 08:14 subsystem
-&gt; ../../../../../../class/net -rw-r--r-- 1 root root 4096 2007-11-22
08:14 tx_queue_len -r--r--r-- 1 root root 4096 2007-11-22 08:14 type
-rw-r--r-- 1 root root 4096 2007-11-22 08:14 uevent

IMHO, this is where a CAN driver could add more attributes. AFAIK, all
of the above are created by the netdev core, so a CAN driver doesn't
need extra code for these. It might be just &quot;baudrate&quot; that should be
added here. We should define a set of attributes that every socketcan
driver must create. This is necessary because userspace code must rely
on certain files to be present. We cannot have one driver create a
&quot;baudrate&quot; file and another calling the same thing &quot;speed&quot; or so.

You could also have a look at hwmon, where almost every driver adds
_lots_ of sysfs attributes (lm93 creates about 160 sysfs files).

For now, I'd suggest to create a text file called socketcan-sysfs,
define the &quot;baudrate&quot; attribute there, and add it to Documentation/.
Then we should add it to _every_ driver. Other attributes can be added
when needed. And we should ask the netdev people if they agree.

Thanks,
Hans



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000840.html">[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
</A></li>
	<LI>Next message: <A HREF="000843.html">[PATCH 0/10] SJA1000DEV using device interface and further fixes	and improvements
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#842">[ date ]</a>
              <a href="thread.html#842">[ thread ]</a>
              <a href="subject.html#842">[ subject ]</a>
              <a href="author.html#842">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
