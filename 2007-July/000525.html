<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> Current HAL interface
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2007-July/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20Current%20HAL%20interface&In-Reply-To=%3C4687E190.9000601%40hartkopp.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000526.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>Current HAL interface</H1>
    <B>Oliver Hartkopp</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20Current%20HAL%20interface&In-Reply-To=%3C4687E190.9000601%40hartkopp.net%3E"
       TITLE="Current HAL interface">socketcan at hartkopp.net
       </A><BR>
    <I>Sun Jul  1 19:17:04 CEST 2007</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000526.html">Current HAL interface
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#525">[ date ]</a>
              <a href="thread.html#525">[ thread ]</a>
              <a href="subject.html#525">[ subject ]</a>
              <a href="author.html#525">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Wolfgang Grandegger wrote:
&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> I'm going to implement a Socket-CAN driver for the CPC-PCI card from EMS 
</I>&gt;<i> Wuensche. The current HAL interface used for the SJA1000 seems a bit 
</I>&gt;<i> special and non-standard to me. I think we should use 
</I>&gt;<i> platform_driver_register or pci_driver_register to register device 
</I>&gt;<i> drivers as already done for MSCAN with MPC5200.
</I>
The HAL approach is just taken from the OCAN driver (as documented in
the comment section of the HAL modules). I recognized myself that it is
e.g. not suitable for parport support. And it also does not look to fit
in PCMCIA and PCI cases. The current HAL approach helps for different
types of memory mapped or i/o mapped controller access (like the old ISA
stuff).

So i don't have any objections to have a more flexible solution here.
It's welcome ;-)

&gt;<i>  A device interface is 
</I>&gt;<i> available in &quot;net/can/dev.c&quot;. Or have I missed something?
</I>&gt;<i>   
</I>
I'm currently a bit unsure, if we would need an extra alloc_candev() or
if alloc_netdev() should be the first choice. The struct can_device is
not my favourite ...

&gt;<i> BTW: &quot;net/can/dev.c&quot; also implements IOCTL requests SIOC[SG]CAN* like 
</I>&gt;<i> SIOCSCANBAUDRATE. Has it become clear in the meantime how to manage 
</I>&gt;<i> device properties with 2.6.
</I>&gt;<i>   
</I>
Urs is currently working on the netlink interface support for the vcan
driver as this defined to be the new way (since 2.6.23) to create and
remove software devices. And indeed this netlink support turned out to
be a 'must have' for new software devices :-/
Don't know if this is an appropriate way for 'real' drivers also. ???

&gt;<i> Wolfgang.
</I>&gt;<i>
</I>&gt;<i> PS: nice to see the Socket-CAN kernel inclusion progressing well :-).
</I>&gt;<i>
</I>&gt;<i>   
</I>
We're giving our very best ;-)

Best regards,
Oliver



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000526.html">Current HAL interface
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#525">[ date ]</a>
              <a href="thread.html#525">[ thread ]</a>
              <a href="subject.html#525">[ subject ]</a>
              <a href="author.html#525">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
