<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [PATCH] mcp251x fixes
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2009-October/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%5D%20mcp251x%20fixes&In-Reply-To=%3C4ADEBC60.9040305%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="003292.html">
   <LINK REL="Next"  HREF="003299.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[PATCH] mcp251x fixes</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20%5BPATCH%5D%20mcp251x%20fixes&In-Reply-To=%3C4ADEBC60.9040305%40grandegger.com%3E"
       TITLE="[PATCH] mcp251x fixes">wg at grandegger.com
       </A><BR>
    <I>Wed Oct 21 09:46:40 CEST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="003292.html">[PATCH] mcp251x fixes
</A></li>
        <LI>Next message: <A HREF="003299.html">[PATCH] mcp251x fixes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3298">[ date ]</a>
              <a href="thread.html#3298">[ thread ]</a>
              <a href="subject.html#3298">[ subject ]</a>
              <a href="author.html#3298">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Christian,

are you heading for kernel inclusion? I browsed the mpc251x.c file and
realized various issues which should be fixed for inclusion. How do you
want to proceed? Fix SVN trunk first or directly prepare patches for
inclusion (based on net-next-2.6) and do the backport thereafter?

christian pellegrin wrote:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> On Mon, Oct 19, 2009 at 10:42 AM, Wolfgang Grandegger &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-core">wg at grandegger.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;&gt;<i> example I discovered by chance that when I disconnect the bus the
</I>&gt;&gt;&gt;<i> mcp2510 goes in rx error passive and when I short-circuit it goes into
</I>&gt;&gt;&gt;<i> tx error passive and then bus off). Any more testing is much
</I>&gt;&gt;<i> That's the normal behavior, just the direction seems wrong.
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> let me add that I was cangen-ing in both directions to catch race conditions.
</I>&gt;<i> 
</I>&gt;<i> Here comes the patch:
</I>&gt;<i> 
</I>&gt;<i> ---8&lt;-----
</I>&gt;<i> This patch:
</I>&gt;<i> 
</I>&gt;<i> - fixes a bug in interpreting RTR frames with no extended-id frames
</I>&gt;<i> 
</I>&gt;<i> - fixes missing device name in bittiming struct and other minor
</I>&gt;<i>   buglets.
</I>&gt;<i> 
</I>&gt;<i> - implements correct behaviour on bus-off (according to
</I>&gt;<i>   can_restart_ms setting). If can_restart_ms is zero the mcp251x
</I>&gt;<i>   is put on sleep until restarted.
</I>
A RESTARTED error messages should be sent in case of automatic recovery.
I don't find it in the code.

&gt;<i> - fixes not handling CANINTF_MERRF irq
</I>&gt;<i> 
</I>&gt;<i> - takes out warnings that give false positives on bus errors
</I>&gt;<i> 
</I>&gt;<i> - fixes sending multiple errors frames on bus state transitions.
</I>&gt;<i>   Now only one frame is generated on each transition.
</I>&gt;<i> 
</I>&gt;<i> Signed-off: Christian Pellegrin &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/socketcan-core">chripell at fsfe.org</A>&gt;
</I>
For all other issues I prefer to comment on mpc251x.c.

Wolfgang.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="003292.html">[PATCH] mcp251x fixes
</A></li>
	<LI>Next message: <A HREF="003299.html">[PATCH] mcp251x fixes
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#3298">[ date ]</a>
              <a href="thread.html#3298">[ thread ]</a>
              <a href="subject.html#3298">[ subject ]</a>
              <a href="author.html#3298">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
