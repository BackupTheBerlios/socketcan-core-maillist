<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> REC and TEC
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/socketcan-core/2008-November/index.html" >
   <LINK REL="made" HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20REC%20and%20TEC&In-Reply-To=%3C4924586F.9080006%40grandegger.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002102.html">
   <LINK REL="Next"  HREF="002107.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>REC and TEC</H1>
    <B>Wolfgang Grandegger</B> 
    <A HREF="mailto:socketcan-core%40lists.berlios.de?Subject=Re%3A%20REC%20and%20TEC&In-Reply-To=%3C4924586F.9080006%40grandegger.com%3E"
       TITLE="REC and TEC">wg at grandegger.com
       </A><BR>
    <I>Wed Nov 19 19:18:23 CET 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="002102.html">REC and TEC
</A></li>
        <LI>Next message: <A HREF="002107.html">REC and TEC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2106">[ date ]</a>
              <a href="thread.html#2106">[ thread ]</a>
              <a href="subject.html#2106">[ subject ]</a>
              <a href="author.html#2106">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Claudio Lanconelli wrote:
&gt;<i> Wolfgang Grandegger ha scritto:
</I>&gt;&gt;<i> Claudio Lanconelli wrote:
</I>&gt;&gt;&gt;<i> Wolfgang Grandegger ha scritto:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Nevertheless, we could insert txerr and rxerr into the error frames as
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> this information is highly hardware dependent anyhow. I have already a
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> patch hanging around.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Can you post it? Thank you.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> For what CAN controller? Is the above reporting not enough?
</I>&gt;&gt;&gt;&gt;&gt;<i> MCP2515
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I'll try to add REC and TEC in data[5] and data[6] of error frames.
</I>&gt;&gt;&gt;&gt;&gt;<i> If I understand well data[5..7] are free for any additional controller
</I>&gt;&gt;&gt;&gt;&gt;<i> specific information.
</I>&gt;&gt;&gt;&gt;<i> I would add it to the end, e.g. data[6] and data[7]. Are you really
</I>&gt;&gt;&gt;&gt;<i> interested in the counter values in between active, warning, passive and
</I>&gt;&gt;&gt;&gt;<i> bus-off levels?
</I>&gt;&gt;&gt;<i> Yes, if it's possible. Or at least a programmable error warning threshold.
</I>&gt;&gt;<i> There are already such thresholds defined by the hardware generating an
</I>&gt;&gt;<i> interrupt which will generate an error frame, if enabled, which then
</I>&gt;&gt;<i> application can handle. Is that not enough?
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> The problem is that warning thresholds are not programmable, at least on
</I>&gt;<i> MCP2515 is fixed to 96. I don't know if it's a standard value or if
</I>&gt;<i> other controllers can change it.
</I>
Some controllers support threshold programming. But usually you have the
following thresholds:

  error warning: errors &gt;=  96
  error passive: errors &gt;= 128
  bus off      : errors &gt;= 256

&gt;<i> Instead MCP2515 has a message error interrupt (MERR), so it's possible
</I>&gt;<i> to send an error frame for every message error with updated REC and TEC,
</I>&gt;<i> or alternatively set a software warning threshold to a programmable value.
</I>
The latter makes more sense because the MCP2510 controller seems not
provide information on the cause of the error, like the SJA1000.
Creating an error frame just to deliver the TXERR and RXERR value to
user space is overkill and may cause the infamous bus error flooding.

Wolfgang.


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002102.html">REC and TEC
</A></li>
	<LI>Next message: <A HREF="002107.html">REC and TEC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2106">[ date ]</a>
              <a href="thread.html#2106">[ thread ]</a>
              <a href="subject.html#2106">[ subject ]</a>
              <a href="author.html#2106">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/socketcan-core">More information about the Socketcan-core
mailing list</a><br>
</body></html>
